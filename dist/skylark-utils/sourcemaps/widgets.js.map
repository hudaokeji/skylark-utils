{"version":3,"sources":["widgets.js"],"names":["define","skylark","langx","noder","datax","styler","geom","eventer","query","velm","widgets","defineWidgetClass","name","base","prototype","Widget","Evented","inherit","init","el","options","isHtmlNode","this","mixin","cid","uniqueId","_ensureElement","tagName","$","selector","$el","find","render","remove","_removeElement","unlistenTo","setElement","element","undelegateEvents","_setElement","delegateEvents","events","result","key","method","isFunction","match","delegateEventSplitter","delegate","proxy","eventName","listener","on","uid","off","undelegate","_createElement","attrs","createElement","id","className","_setAttributes","attributes","attr","i18n","message","context","messages","toString","each","value","replace"],"mappings":"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","file":"../widgets.js","sourcesContent":["define([\r\n    \"./skylark\",\r\n    \"./langx\",\r\n    \"./noder\",\r\n    \"./datax\",\r\n    \"./styler\",\r\n    \"./geom\",\r\n    \"./eventer\",\r\n    \"./query\",\r\n    \"./velm\"\r\n], function(skylark,langx,noder, datax, styler, geom, eventer,query,velm) {\r\n\tfunction widgets() {\r\n\t    return widgets;\r\n\t}\r\n\r\n\tvar Widget = langx.Evented.inherit({\r\n\t    init :function(el,options) {\r\n\t    \t//for supporting init(options,el)\r\n\t        if (langx.isHtmlNode(options)) {\r\n\t        \tvar _t = el,\r\n\t        \t\toptions = el;\r\n\t            el = options;\r\n\t        }\r\n\t        if (langx.isHtmlNode(el)) { \r\n\t        \tthis.el = el;\r\n\t    \t} else {\r\n\t    \t\tthis.el = null;\r\n\t    \t}\r\n\t        if (options) {\r\n\t            langx.mixin(this,options);\r\n\t        }\r\n\t        if (!this.cid) {\r\n\t            this.cid = langx.uniqueId('w');\r\n\t        }\r\n\t        this._ensureElement();\r\n\t    },\r\n\r\n\t    // The default `tagName` of a View's element is `\"div\"`.\r\n\t    tagName: 'div',\r\n\r\n\t    // query delegate for element lookup, scoped to DOM elements within the\r\n\t    // current view. This should be preferred to global lookups where possible.\r\n\t    $: function(selector) {\r\n\t      return this.$el.find(selector);\r\n\t    },\r\n\r\n\t    // **render** is the core function that your view should override, in order\r\n\t    // to populate its element (`this.el`), with the appropriate HTML. The\r\n\t    // convention is for **render** to always return `this`.\r\n\t    render: function() {\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Remove this view by taking the element out of the DOM, and removing any\r\n\t    // applicable Backbone.Events listeners.\r\n\t    remove: function() {\r\n\t      this._removeElement();\r\n\t      this.unlistenTo();\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Remove this view's element from the document and all event listeners\r\n\t    // attached to it. Exposed for subclasses using an alternative DOM\r\n\t    // manipulation API.\r\n\t    _removeElement: function() {\r\n\t      this.$el.remove();\r\n\t    },\r\n\r\n\t    // Change the view's element (`this.el` property) and re-delegate the\r\n\t    // view's events on the new element.\r\n\t    setElement: function(element) {\r\n\t      this.undelegateEvents();\r\n\t      this._setElement(element);\r\n\t      this.delegateEvents();\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Creates the `this.el` and `this.$el` references for this view using the\r\n\t    // given `el`. `el` can be a CSS selector or an HTML string, a jQuery\r\n\t    // context or an element. Subclasses can override this to utilize an\r\n\t    // alternative DOM manipulation API and are only required to set the\r\n\t    // `this.el` property.\r\n\t    _setElement: function(el) {\r\n\t      this.$el = widgets.$(el);\r\n\t      this.el = this.$el[0];\r\n\t    },\r\n\r\n\t    // Set callbacks, where `this.events` is a hash of\r\n\t    //\r\n\t    // *{\"event selector\": \"callback\"}*\r\n\t    //\r\n\t    //     {\r\n\t    //       'mousedown .title':  'edit',\r\n\t    //       'click .button':     'save',\r\n\t    //       'click .open':       function(e) { ... }\r\n\t    //     }\r\n\t    //\r\n\t    // pairs. Callbacks will be bound to the view, with `this` set properly.\r\n\t    // Uses event delegation for efficiency.\r\n\t    // Omitting the selector binds the event to `this.el`.\r\n\t    delegateEvents: function(events) {\r\n\t      events || (events = langx.result(this, 'events'));\r\n\t      if (!events) return this;\r\n\t      this.undelegateEvents();\r\n\t      for (var key in events) {\r\n\t        var method = events[key];\r\n\t        if (!langx.isFunction(method)) method = this[method];\r\n\t        if (!method) continue;\r\n\t        var match = key.match(delegateEventSplitter);\r\n\t        this.delegate(match[1], match[2], langx.proxy(method, this));\r\n\t      }\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Add a single event listener to the view's element (or a child element\r\n\t    // using `selector`). This only works for delegate-able events: not `focus`,\r\n\t    // `blur`, and not `change`, `submit`, and `reset` in Internet Explorer.\r\n\t    delegate: function(eventName, selector, listener) {\r\n\t      this.$el.on(eventName + '.delegateEvents' + this.uid, selector, listener);\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Clears all callbacks previously bound to the view by `delegateEvents`.\r\n\t    // You usually don't need to use this, but may wish to if you have multiple\r\n\t    // Backbone views attached to the same DOM element.\r\n\t    undelegateEvents: function() {\r\n\t      if (this.$el) this.$el.off('.delegateEvents' + this.uid);\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // A finer-grained `undelegateEvents` for removing a single delegated event.\r\n\t    // `selector` and `listener` are both optional.\r\n\t    undelegate: function(eventName, selector, listener) {\r\n\t      this.$el.off(eventName + '.delegateEvents' + this.uid, selector, listener);\r\n\t      return this;\r\n\t    },\r\n\r\n\t    // Produces a DOM element to be assigned to your view. Exposed for\r\n\t    // subclasses using an alternative DOM manipulation API.\r\n\t    _createElement: function(tagName,attrs) {\r\n\t      return noder.createElement(tagName,attrs);\r\n\t    },\r\n\r\n\t    // Ensure that the View has a DOM element to render into.\r\n\t    // If `this.el` is a string, pass it through `$()`, take the first\r\n\t    // matching element, and re-assign it to `el`. Otherwise, create\r\n\t    // an element from the `id`, `className` and `tagName` properties.\r\n\t    _ensureElement: function() {\r\n\t      if (!this.el) {\r\n\t        var attrs = langx.mixin({}, langx.result(this, 'attributes'));\r\n\t        if (this.id) attrs.id = langx.result(this, 'id');\r\n\t        if (this.className) attrs['class'] = langx.result(this, 'className');\r\n\t        this.setElement(this._createElement(langx.result(this, 'tagName'),attrs));\r\n\t        this._setAttributes(attrs);\r\n\t      } else {\r\n\t        this.setElement(langx.result(this, 'el'));\r\n\t      }\r\n\t    },\r\n\r\n\t    // Set attributes from a hash on this view's element.  Exposed for\r\n\t    // subclasses using an alternative DOM manipulation API.\r\n\t    _setAttributes: function(attributes) {\r\n\t      this.$el.attr(attributes);\r\n\t    },\r\n\r\n\t    // Translation function, gets the message key to be translated\r\n\t    // and an object with context specific data as arguments:\r\n\t    i18n: function (message, context) {\r\n\t        message = (this.messages && this.messages[message]) || message.toString();\r\n\t        if (context) {\r\n\t            langx.each(context, function (key, value) {\r\n\t                message = message.replace('{' + key + '}', value);\r\n\t            });\r\n\t        }\r\n\t        return message;\r\n\t    },\r\n\r\n\t\t});\r\n\r\n\tfunction defineWidgetClass(name,base,prototype) {\r\n\r\n\t};\r\n\r\n\tlangx.mixin(widgets, {\r\n\t\t$ : query,\r\n\r\n\t\tdefine : defineWidgetClass,\r\n\t\tWidget : Widget\r\n\t});\r\n\r\n\r\n\treturn skylark.widgets = widgets;\r\n});\r\n"]}